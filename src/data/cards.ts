import type { Card } from '@/types/card';

export const CARDS: Card[] = [
  // ── VOLT (Yellow/Electric - Aggressive) ──────────────────────────────────
  {
    id: 'volt_spark_drone',
    name: 'Spark Drone',
    energy: 'volt',
    type: 'agent',
    cost: 1,
    rarity: 'common',
    attack: 1,
    defense: 1,
    keywords: [{ keyword: 'overclock' }],
    description: 'Overclock — Attacks twice on the turn it is played.',
  },
  {
    id: 'volt_shock_trooper',
    name: 'Shock Trooper',
    energy: 'volt',
    type: 'agent',
    cost: 2,
    rarity: 'common',
    attack: 2,
    defense: 2,
    keywords: [],
    description: 'A hardened street enforcer running on raw voltage.',
  },
  {
    id: 'volt_thunder_runner',
    name: 'Thunder Runner',
    energy: 'volt',
    type: 'agent',
    cost: 3,
    rarity: 'uncommon',
    attack: 3,
    defense: 2,
    keywords: [{ keyword: 'overclock' }],
    description: 'Overclock — Speed is everything on Neon Row.',
  },
  {
    id: 'volt_arc_sentinel',
    name: 'Arc Sentinel',
    energy: 'volt',
    type: 'agent',
    cost: 4,
    rarity: 'uncommon',
    attack: 4,
    defense: 3,
    keywords: [],
    effect: { type: 'damage', value: 1, target: 'any', description: 'When played: deal 1 damage to any target.' },
    description: 'When played: deal 1 damage to any target.',
  },
  {
    id: 'volt_storm_colossus',
    name: 'Storm Colossus',
    energy: 'volt',
    type: 'agent',
    cost: 6,
    rarity: 'rare',
    attack: 6,
    defense: 5,
    keywords: [{ keyword: 'overclock' }],
    description: 'Overclock — The Grid trembles at its approach.',
  },
  {
    id: 'volt_zap',
    name: 'Zap',
    energy: 'volt',
    type: 'script',
    cost: 1,
    rarity: 'common',
    effect: { type: 'damage', value: 2, target: 'any', description: 'Deal 2 damage to any target.' },
    description: 'Deal 2 damage to any target.',
  },
  {
    id: 'volt_emp_burst',
    name: 'EMP Burst',
    energy: 'volt',
    type: 'script',
    cost: 3,
    rarity: 'uncommon',
    effect: { type: 'damage', value: 3, target: 'all_enemy_agents', description: 'Deal 3 damage to all enemy Agents.' },
    description: 'Deal 3 damage to all enemy Agents.',
  },
  {
    id: 'volt_overcharge',
    name: 'Overcharge',
    energy: 'volt',
    type: 'script',
    cost: 2,
    rarity: 'common',
    effect: { type: 'buff', value: 2, target: 'self', description: 'One of your Agents gains +2 Attack this turn.' },
    description: 'One of your Agents gains +2 Attack this turn.',
  },
  {
    id: 'volt_static_field',
    name: 'Static Field',
    energy: 'volt',
    type: 'malware',
    cost: 3,
    rarity: 'uncommon',
    effect: { type: 'buff', value: 1, target: 'all_agents', description: 'Your Volt Agents have +1 Attack.' },
    description: 'Your Volt Agents have +1 Attack.',
  },
  {
    id: 'volt_voltage_trap',
    name: 'Voltage Trap',
    energy: 'volt',
    type: 'trap',
    cost: 2,
    rarity: 'uncommon',
    triggerCondition: 'on_play_agent',
    effect: { type: 'damage', value: 2, target: 'enemy_agent', description: 'When the enemy plays an Agent, deal 2 damage to it.' },
    description: 'When the enemy plays an Agent, deal 2 damage to it.',
  },

  // ── CIPHER (Cyan/Blue - Control) ─────────────────────────────────────────
  {
    id: 'cipher_data_sprite',
    name: 'Data Sprite',
    energy: 'cipher',
    type: 'agent',
    cost: 1,
    rarity: 'common',
    attack: 1,
    defense: 2,
    keywords: [{ keyword: 'decrypt' }],
    description: 'Decrypt — When played, look at the top card of the enemy deck.',
  },
  {
    id: 'cipher_logic_weaver',
    name: 'Logic Weaver',
    energy: 'cipher',
    type: 'agent',
    cost: 2,
    rarity: 'common',
    attack: 1,
    defense: 3,
    keywords: [],
    effect: { type: 'draw', value: 1, target: 'player', description: 'When played: draw 1 card.' },
    description: 'When played: draw 1 card.',
  },
  {
    id: 'cipher_code_breaker',
    name: 'Code Breaker',
    energy: 'cipher',
    type: 'agent',
    cost: 3,
    rarity: 'uncommon',
    attack: 2,
    defense: 4,
    keywords: [{ keyword: 'decrypt' }],
    description: 'Decrypt — Cracks enemy protocols on entry.',
  },
  {
    id: 'cipher_firewall_guardian',
    name: 'Firewall Guardian',
    energy: 'cipher',
    type: 'agent',
    cost: 5,
    rarity: 'rare',
    attack: 3,
    defense: 6,
    keywords: [],
    description: 'Your other Agents cannot be targeted by enemy Scripts.',
  },
  {
    id: 'cipher_quantum_ghost',
    name: 'Quantum Ghost',
    energy: 'cipher',
    type: 'agent',
    cost: 4,
    rarity: 'uncommon',
    attack: 3,
    defense: 3,
    keywords: [{ keyword: 'stealth' }],
    description: 'Stealth — Cannot be blocked for 1 turn.',
  },
  {
    id: 'cipher_ping',
    name: 'Ping',
    energy: 'cipher',
    type: 'script',
    cost: 0,
    rarity: 'common',
    effect: { type: 'draw', value: 1, target: 'player', description: 'Draw 1 card.' },
    description: 'Draw 1 card.',
  },
  {
    id: 'cipher_system_reboot',
    name: 'System Reboot',
    energy: 'cipher',
    type: 'script',
    cost: 4,
    rarity: 'uncommon',
    effect: { type: 'bounce', value: 0, target: 'enemy_agent', description: 'Return an enemy Agent to their hand.' },
    description: 'Return an enemy Agent to their hand.',
  },
  {
    id: 'cipher_null_pointer',
    name: 'Null Pointer',
    energy: 'cipher',
    type: 'script',
    cost: 2,
    rarity: 'uncommon',
    effect: { type: 'counter', value: 0, target: 'enemy_agent', description: "Cancel an enemy Agent's enter-play effect." },
    description: "Cancel an enemy Agent's enter-play effect.",
  },
  {
    id: 'cipher_encryption_layer',
    name: 'Encryption Layer',
    energy: 'cipher',
    type: 'malware',
    cost: 2,
    rarity: 'common',
    effect: { type: 'buff', value: 1, target: 'all_agents', description: 'Your Cipher Agents have +1 Defense.' },
    description: 'Your Cipher Agents have +1 Defense.',
  },
  {
    id: 'cipher_logic_bomb',
    name: 'Logic Bomb',
    energy: 'cipher',
    type: 'trap',
    cost: 3,
    rarity: 'rare',
    triggerCondition: 'on_play_script',
    effect: { type: 'counter', value: 0, target: 'any', description: "When the enemy plays a Script, cancel it." },
    description: "When the enemy plays a Script, cancel it.",
  },

  // ── NEUTRAL ───────────────────────────────────────────────────────────────
  {
    id: 'neutral_street_runner',
    name: 'Street Runner',
    energy: 'neutral',
    type: 'agent',
    cost: 1,
    rarity: 'common',
    attack: 1,
    defense: 1,
    keywords: [],
    description: 'A basic runner — nothing special, but reliable.',
  },
  {
    id: 'neutral_scrap_bot',
    name: 'Scrap Bot',
    energy: 'neutral',
    type: 'agent',
    cost: 2,
    rarity: 'common',
    attack: 2,
    defense: 2,
    keywords: [],
    description: 'Salvaged hardware, repurposed for the fight.',
  },
  {
    id: 'neutral_supply_crate',
    name: 'Supply Crate',
    energy: 'neutral',
    type: 'script',
    cost: 1,
    rarity: 'common',
    effect: { type: 'draw', value: 1, target: 'player', description: 'Draw 1 card and gain 1 temporary Data Cell.' },
    description: 'Draw 1 card and gain 1 temporary Data Cell.',
  },
  {
    id: 'neutral_emergency_patch',
    name: 'Emergency Patch',
    energy: 'neutral',
    type: 'script',
    cost: 1,
    rarity: 'common',
    effect: { type: 'heal', value: 3, target: 'player', description: 'Restore 3 HP.' },
    description: 'Restore 3 HP.',
  },
  {
    id: 'neutral_grid_surge',
    name: 'Grid Surge',
    energy: 'neutral',
    type: 'script',
    cost: 3,
    rarity: 'uncommon',
    effect: { type: 'buff', value: 1, target: 'all_agents', description: 'All your Agents gain +1/+1 this turn.' },
    description: 'All your Agents gain +1/+1 this turn.',
  },
];

// Map for fast lookup
export const CARD_MAP: Record<string, Card> = Object.fromEntries(
  CARDS.map((c) => [c.id, c])
);

// Helper to get a card by ID (returns undefined if not found)
export const getCard = (id: string): Card | undefined => CARD_MAP[id];

// Starter deck card IDs with quantities
const STARTER_DECK_IDS: { id: string; qty: number }[] = [
  { id: 'neutral_street_runner', qty: 4 },
  { id: 'neutral_scrap_bot', qty: 3 },
  { id: 'volt_spark_drone', qty: 3 },
  { id: 'volt_shock_trooper', qty: 2 },
  { id: 'volt_zap', qty: 2 },
  { id: 'cipher_data_sprite', qty: 2 },
  { id: 'cipher_ping', qty: 2 },
  { id: 'neutral_emergency_patch', qty: 1 },
  { id: 'neutral_supply_crate', qty: 1 },
];

// Build starter deck as Card array (with unique instanceIds handled at runtime)
export const STARTER_DECK: Card[] = STARTER_DECK_IDS.flatMap(({ id, qty }) => {
  const card = CARD_MAP[id];
  if (!card) return [];
  return Array(qty).fill(card);
});
